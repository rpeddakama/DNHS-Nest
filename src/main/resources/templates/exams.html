<!DOCTYPE HTML>
<html xmlns:layout="http://www.w3.org/1999/xhtml"
  xmlns:th="http://www.w3.org/1999/xhtml"
  layout:decorate="~{fragments/layout}" lang="en">

  <head>
    <div layout:fragment="metadata" th:remove="tag">
      <title>The Nest - Calendar</title>
    </div>
  </head>

  <body>
    <div layout:fragment="content" th:remove="tag">
      <div>
        <form action="/exams" method="GET" id="addEvent">
          <div class="frq-form">
            <br />
            <input name="examNameField" id="addEvent" placeholder="Exam Name (ex. Unit 2 Exam)">
            <br />
            <input name="classNameField" id="addEvent" placeholder="Class Name (ex. AP Calculus BC)">
            <br />
            <input name="teacherField" id="addEvent" placeholder="Teacher (ex. Mr. Smith)">
            <br />
            <input name="classPeriodField" id="addEvent" placeholder="Class Period (ex. 2)">
            <br />
            <input name="examDateField" id="addEvent" placeholder="Exam Date (ex. 2022-02-04)">
            <br />
            <button th:attr="onclick=|addExam('${examName}', '${className}',
              '${classPeriod}',
              '${teacher}', '${examDate}')|">Add Event</button>
          </div>
        </form>
      </div>

      <div class="calendar" id='calendar'></div>

      <script th:inline="javascript">
        var calendarEl = document.getElementById('calendar');

        var calendar = new FullCalendar.Calendar(calendarEl, {
          initialView: 'dayGridMonth',
          initialDate: '2022-02-07',
          headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay'
          },

          eventDidMount: function(info) {
            console.log(info.event._def.title)
          },

          eventMouseEnter: function(calEvent, jsEvent) {
            console.log("hover enter")
          },

          eventMouseLeave: function() {
            console.log("hover leave")
          },
        });

        function addExam(examName, className, classPeriod, teacher, examDate) {
          console.log("add exam")
          calendar.addEvent( 
            {
              title: "Period " + classPeriod + " " + examName + " for " + teacher + "'s " + className + " Class",
              start: examDate,
            },
          );
        }

        calendar.render();

        eventList = /*[[${eventList}]]*/
        null

        console.log(eventList.length)
        for (let i = 0; i < eventList.length; i++) {
          addExam(eventList[i].examName, eventList[i].className, eventList[i].classPeriod, eventList[i].teacher, eventList[i].examDate)
        }
      </script>
    </div>
  </body>

</html>